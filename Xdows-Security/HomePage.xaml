<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Xdows_Security.HomePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:l="using:WinUI3Localizer"
    mc:Ignorable="d">

    <Grid Margin="64,0,64,0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
            <FontIcon x:Name="Icon" Margin="16,0,0,0" HorizontalAlignment="Left" Glyph="&#xE73E;" FontSize="124" FontWeight="Bold"/>
            <StackPanel Margin="24,16,0,0" Orientation="Vertical">
                <TextBlock Margin="0,12,0,0" x:Name="HomePage_TextBlock" FontSize="28" FontWeight="Bold"/>
                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                    <TextBlock x:Name="HomePage_Pomes"
                      Style="{StaticResource BodyTextBlockStyle}"
                      VerticalAlignment="Center"
                      IsTextSelectionEnabled="True" />

                    <Button Content="刷新"
                Click="RefreshPomes_Click"
                            Height="32"
                Margin="16,0,0,0"/>
                </StackPanel>
            </StackPanel>
        </StackPanel>
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Hidden">
            <StackPanel Spacing="10">
                <Border BorderThickness="1" BorderBrush="{ThemeResource CardStrokeColorDefaultSolid}" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                    <StackPanel>
                        <TextBlock Text="扫描统计" FontSize="18" FontWeight="Bold" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <TextBlock Text="总扫描数" FontSize="15" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="TotalScansText" Text="0" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,20,0,0"/>
                            </Grid>
                            <Grid Grid.Column="1">
                                <TextBlock Text="发现威胁" FontSize="15" FontWeight="SemiBold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="TotalThreatsText" Text="0" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,20,0,0"/>
                            </Grid>
                        </Grid>
                        <StackPanel Orientation="Horizontal" FlowDirection="RightToLeft" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                            <Button Grid.Row="0" Content="刷新统计信息" Click="RefreshStatistics_Click" HorizontalAlignment="Left"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border BorderThickness="1" BorderBrush="{ThemeResource CardStrokeColorDefaultSolid}" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                    <StackPanel>
                        <TextBlock l:Uids.Uid="HomePage_ProtectionStatus" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock l:Uids.Uid="HomePage_Protection" Grid.Column="0" Margin="0,0,10,0"/>
                            <TextBlock x:Name="ProtectionStatusText" Grid.Column="1" l:Uids.Uid="AllPage_Loading" />
                        </Grid>
                        <Grid Margin="0,5,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock l:Uids.Uid="HomePage_LastScan" Grid.Column="0" Margin="0,0,10,0"/>
                            <TextBlock x:Name="LastScanText" Grid.Column="1" l:Uids.Uid="AllPage_Undefined"/>
                        </Grid>
                        <Grid Margin="0,5,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock l:Uids.Uid="HomePage_NumberOfThreats" Grid.Column="0" Margin="0,0,10,0"/>
                            <TextBlock x:Name="ThreatCountText" Grid.Column="1" Text="0"/>
                        </Grid>
                    </StackPanel>
                </Border>
                <Border BorderThickness="1" BorderBrush="{ThemeResource CardStrokeColorDefaultSolid}" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                    <StackPanel>
                        <TextBlock l:Uids.Uid="HomePage_SystemInfo" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock l:Uids.Uid="HomePage_OSName" Grid.Column="0" Margin="0,0,10,0"/>
                            <TextBlock x:Name="OSNameText" Grid.Column="1" l:Uids.Uid="AllPage_Loading" />
                        </Grid>
                        <Grid Margin="0,5,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock l:Uids.Uid="HomePage_OSVersion"  Grid.Column="0" Margin="0,0,10,0"/>
                            <TextBlock x:Name="OSVersionText" Grid.Column="1" l:Uids.Uid="AllPage_Loading" />
                        </Grid>
                        <Grid Margin="0,5,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock l:Uids.Uid="HomePage_OSMemory" Grid.Column="0" Margin="0,0,10,0"/>
                            <TextBlock x:Name="MemoryUsageText" Grid.Column="1" l:Uids.Uid="AllPage_Loading" />
                        </Grid>
                        <StackPanel Orientation="Horizontal" FlowDirection="RightToLeft" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                            <Button l:Uids.Uid="HomePage_RefreshSystemInfo" Click="RefreshSystemInfo_Click" Margin="0,16,0,0" HorizontalAlignment="Left"/>
                            <Button l:Uids.Uid="HomePage_CopySystemInfo" Click="CopySystemInfo_Click" Margin="0,16,0,0" HorizontalAlignment="Left"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                <Border Margin="0,0,0,16" BorderThickness="1" BorderBrush="{ThemeResource CardStrokeColorDefaultSolid}" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8" Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="运行日志" FontSize="18" FontWeight="Bold"/>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="0,32,0,8">
                            <Button Content="清空日志" Click="ClearLog_Click"/>
                            <Button Content="导出日志" Click="ExportLog_Click"/>
                            <DropDownButton x:Name="LogLevelFilter" Content="筛选日志">
                                <DropDownButton.Flyout>
                                    <MenuFlyout>
                                        <ToggleMenuFlyoutItem Tag="All"     Text="全部"   Click="LogLevelFilter_MenuClick" IsChecked="True"/>
                                        <MenuFlyoutSeparator/>
                                        <ToggleMenuFlyoutItem Tag="UNKNOWN" Text="未定义" Click="LogLevelFilter_MenuClick" IsChecked="True"/>
                                        <ToggleMenuFlyoutItem Tag="DEBUG"   Text="调试"   Click="LogLevelFilter_MenuClick" IsChecked="True"/>
                                        <ToggleMenuFlyoutItem Tag="INFO"    Text="信息"   Click="LogLevelFilter_MenuClick" IsChecked="True"/>
                                        <ToggleMenuFlyoutItem Tag="WARN"    Text="警告"   Click="LogLevelFilter_MenuClick" IsChecked="True"/>
                                        <ToggleMenuFlyoutItem Tag="ERROR"   Text="错误"   Click="LogLevelFilter_MenuClick" IsChecked="True"/>
                                        <ToggleMenuFlyoutItem Tag="FATAL"   Text="失败"   Click="LogLevelFilter_MenuClick" IsChecked="True"/>
                                    </MenuFlyout>
                                </DropDownButton.Flyout>
                            </DropDownButton>
                        </StackPanel>

                        <ScrollViewer x:Name="LogScroll" Grid.Row="1" Height="216">
                            <ItemsRepeater x:Name="LogRepeater">
                                <ItemsRepeater.Layout>
                                    <StackLayout Spacing="0" />
                                </ItemsRepeater.Layout>
                                <ItemsRepeater.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}"
                                           TextWrapping="Wrap"
                                           FontFamily="Consolas"
                                           Padding="0"
                                           IsTextSelectionEnabled="True"
                                           Height="18"/>
                                    </DataTemplate>
                                </ItemsRepeater.ItemTemplate>
                            </ItemsRepeater>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>